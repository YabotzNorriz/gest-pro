import{a as Y,b as Z}from"./chunk-ROYJVEOW.js";import{a as $,b as ee}from"./chunk-7Q35OXXA.js";import"./chunk-376IKJ6V.js";import"./chunk-QUJFQN2Y.js";import"./chunk-ZY6MMR2N.js";import"./chunk-D7TAPKFE.js";import"./chunk-E3YIA7WN.js";import"./chunk-AIS5GWYL.js";import"./chunk-LALQ4PRD.js";import"./chunk-UW3ZE4H6.js";import"./chunk-BYMGTA2M.js";import"./chunk-EXPIUGSN.js";import"./chunk-RRKDUDD7.js";import"./chunk-XWDJZ25K.js";import"./chunk-MTHZ7MWU.js";import"./chunk-WI5MSH4N.js";import"./chunk-M6NONDRE.js";import"./chunk-CKP3SGE2.js";import"./chunk-SGZNH6GL.js";import"./chunk-PO6P2S23.js";import{$ as n,Aa as V,B as c,Ba as F,Ca as M,D as I,Da as L,Ea as O,G as S,Ha as T,Ia as q,Ja as R,K as h,L as i,M as t,N as r,R as w,S as v,T as x,_ as P,_a as B,fa as y,gb as G,h as b,ka as A,kb as U,lb as z,mb as H,na as N,qb as K,ra as k,rb as X,s as C,t as j,ta as D,wb as J,yb as Q,z as u,za as m,zb as W}from"./chunk-KD4FIKX5.js";import"./chunk-HB7CQCBC.js";import"./chunk-VHBHA3HG.js";import"./chunk-ZPI3MVP3.js";import"./chunk-X23JKFBK.js";import"./chunk-UQSJFG5S.js";import"./chunk-O6FA337S.js";import"./chunk-4WFVMWDK.js";import"./chunk-M2X7KQLB.js";import"./chunk-DVVH2KKN.js";import"./chunk-NV3QH4JK.js";import"./chunk-4YRHGV2P.js";import"./chunk-OZYWYLNK.js";import"./chunk-42C7ZIID.js";import{a as E,b as _,f}from"./chunk-D7YYRZS5.js";function oe(a,l){if(a&1){let p=w();i(0,"div")(1,"form",3),v("ngSubmit",function(){C(p);let e=x();return j(e.onUpdate())}),i(2,"div",4)(3,"h2",5),n(4,"Editar Projeto"),t(),i(5,"ion-list",6)(6,"ion-item")(7,"ion-label"),n(8,"Num projeto"),t(),r(9,"ion-input",7),t(),i(10,"ion-item")(11,"ion-label"),n(12,"Data in\xEDcio"),t(),r(13,"ion-input",8),t(),i(14,"ion-item")(15,"ion-label"),n(16,"Nome Projeto"),t(),r(17,"ion-input",9),t(),i(18,"ion-item")(19,"ion-label"),n(20,"\xC1reas"),t(),r(21,"ion-input",10),t(),i(22,"ion-item")(23,"ion-label"),n(24,"Respons\xE1vel"),t(),r(25,"ion-input",11),t(),i(26,"ion-item")(27,"ion-label"),n(28,"Escopo"),t(),r(29,"ion-textarea",12),t(),i(30,"ion-item")(31,"ion-label"),n(32,"Status"),t(),i(33,"ion-select",13)(34,"ion-select-option",14),n(35,"A Iniciar"),t(),i(36,"ion-select-option",15),n(37,"Em Andamento"),t(),i(38,"ion-select-option",16),n(39,"Conclu\xEDdo"),t()()(),i(40,"ion-item")(41,"ion-label"),n(42,"Tags (separadas por v\xEDrgula)"),t(),r(43,"ion-input",17),t()(),i(44,"div",18)(45,"ion-button",19),n(46,"SALVAR"),t(),i(47,"ion-button",20),v("click",function(){C(p);let e=x();return j(e.onDeleteConfirm())}),n(48,"EXCLUIR"),t(),i(49,"ion-button",21),v("click",function(){C(p);let e=x();return j(e.onClickBtnCancelar())}),n(50,"CANCELAR"),t()()()()()}if(a&2){let p=x();u(),h("formGroup",p.projectForm),u(28),h("autoGrow",!0),u(16),h("disabled",p.projectForm.invalid)}}function ne(a,l){a&1&&(i(0,"div",22),r(1,"ion-spinner",23),i(2,"p"),n(3,"Carregando dados do projeto..."),t()())}var fe=(()=>{let l=class l{constructor(o,e,s,d,g,te,ie){this.fb=o,this.projectService=e,this.router=s,this.route=d,this.alertController=g,this.loadingController=te,this.navCtrl=ie,this.projectId=null,this.isLoading=!0}ngOnInit(){this.projectForm=this.fb.group({numProjeto:["",[m.required]],dataInicio:["",[m.required]],nomeProjeto:["",[m.required]],areas:["",[m.required]],responsavel:["",[m.required]],escopo:["",[m.required]],status:["iniciar",[m.required]],tags:[""]}),this.projectId=this.route.snapshot.paramMap.get("id"),this.projectId?this.loadProjectData(this.projectId):(this.presentAlert("Erro","ID do projeto n\xE3o fornecido."),this.navCtrl.back())}loadProjectData(o){this.isLoading=!0,this.projectService.getProjectById(o).pipe(b(1)).subscribe({next:e=>{if(!e){this.presentAlert("Erro","Projeto n\xE3o encontrado."),this.navCtrl.back();return}let s=Array.isArray(e.tags)?e.tags.join(", "):"",d=_(E({},e),{tags:s});this.projectForm.patchValue(d),this.isLoading=!1},error:e=>{console.error(e),this.presentAlert("Erro","N\xE3o foi poss\xEDvel carregar o projeto."),this.isLoading=!1,this.navCtrl.back()}})}onUpdate(){return f(this,null,function*(){if(!this.projectForm.valid||!this.projectId){this.presentAlert("Erro","Por favor, preencha todos os campos obrigat\xF3rios.");return}let o=yield this.loadingController.create({message:"Atualizando..."});yield o.present();try{let e=this.projectForm.value,s=e.tags.split(",").map(g=>g.trim()).filter(g=>g.length>0),d=_(E({},e),{tags:s});yield this.projectService.updateProject(this.projectId,d),yield o.dismiss(),yield this.presentAlert("Sucesso","Projeto atualizado com sucesso."),this.navCtrl.back()}catch(e){yield o.dismiss(),yield this.presentAlert("Erro","Ocorreu um erro inesperado."),console.error(e)}})}onDeleteConfirm(){return f(this,null,function*(){yield(yield this.alertController.create({header:"Confirmar Exclus\xE3o",message:"Voc\xEA tem certeza que deseja excluir este projeto?",buttons:[{text:"Cancelar",role:"cancel"},{text:"Excluir",handler:()=>{this.deleteProject()}}]})).present()})}deleteProject(){return f(this,null,function*(){if(!this.projectId)return;let o=yield this.loadingController.create({message:"Excluindo..."});yield o.present();try{yield this.projectService.deleteProject(this.projectId),yield o.dismiss(),yield this.presentAlert("Sucesso","Projeto exclu\xEDdo."),this.router.navigateByUrl("/home")}catch(e){yield o.dismiss(),this.presentAlert("Erro","Falha ao excluir o projeto."),console.error(e)}})}presentAlert(o,e){return f(this,null,function*(){yield(yield this.alertController.create({header:o,message:e,buttons:["OK"]})).present()})}onClickBtnCancelar(){this.navCtrl.back()}};l.\u0275fac=function(e){return new(e||l)(c(T),c(Z),c(D),c(k),c($),c(ee),c(R))},l.\u0275cmp=I({type:l,selectors:[["app-projeto-edit"]],decls:5,vars:3,consts:[["loadingTemplate",""],[3,"fullscreen"],[4,"ngIf","ngIfElse"],[3,"ngSubmit","formGroup"],[1,"ion-padding"],[1,"form-title"],["lines","full"],["formControlName","numProjeto","placeholder","exemplo",1,"ion-text-right"],["formControlName","dataInicio","type","date","placeholder","exemplo",1,"ion-text-right"],["formControlName","nomeProjeto","placeholder","exemplo",1,"ion-text-right"],["formControlName","areas","placeholder","exemplo",1,"ion-text-right"],["formControlName","responsavel","placeholder","exemplo",1,"ion-text-right"],["formControlName","escopo","placeholder","exemplo",1,"ion-text-right",3,"autoGrow"],["formControlName","status","placeholder","exemplo",1,"ion-text-right"],["value","iniciar"],["value","andamento"],["value","concluido"],["formControlName","tags","placeholder","ex: tag1, tag2",1,"ion-text-right"],[1,"button-container"],["color","primary","type","submit",1,"form-button",3,"disabled"],["color","danger",1,"form-button","ion-margin-top",3,"click"],["color","light",1,"form-button","ion-margin-top",3,"click"],[1,"loading-container"],["name","crescent"]],template:function(e,s){if(e&1&&(r(0,"app-header"),i(1,"ion-content",1),S(2,oe,51,3,"div",2)(3,ne,4,0,"ng-template",null,0,y),t()),e&2){let d=P(4);u(),h("fullscreen",!0),u(),h("ngIf",!s.isLoading)("ngIfElse",d)}},dependencies:[X,B,W,J,z,U,Y,G,H,Q,K,N,A,q,M,V,F,L,O],styles:[".form-title[_ngcontent-%COMP%]{text-align:center;font-weight:700;color:var(--ion-color-dark)}ion-list[lines=full][_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--inner-padding-end: 0}ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{font-weight:500;color:var(--ion-color-medium-shade)}.button-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;margin-top:2.5rem}.form-button[_ngcontent-%COMP%]{width:220px;height:44px}"]});let a=l;return a})();export{fe as ProjetoEditComponent};
